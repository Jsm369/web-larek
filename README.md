# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов\
\
`constructor(baseUrl: string, options: RequestInit = {})` - Конструктор класса принимает поля `baseUrl` - по которому будут совершаться запросы и `options` - отвечает за дополнительные настройки для этих запросов\
\
Поля: 
- `baseUrl: string` - Хранит базовый URL, к которому будут добавляться относительные URI для формирования полного URL запроса
- `options: RequestInit = {}` - Объект, содержащий настройки для HTTP запросов

Методы:
- `handleResponse`(protected) - используется для обработки ответа от сервера после выполнения HTTP запроса
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий\
\
`constructor()` - Конструктор класса инициализирует брокер событий\
\
Поля:
- `this._events = new Map<EventName, Set<Subscriber>>()` - используется для хранения информации о событиях и их подписчиках

Методы:
- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие   

#### Класс Component`<T>`
Абстрактный класс, который отвечает за создание пользовательского интерфейса\
\
`constructor(protected readonly container: HTMLElement)`(protected) - Конструктор класса принимает параметр в который будет рендериться компонент\
\
Поля:
- `container: HTMLElement`(protected) - параметр используемый для хранения ссылки на корневой элемент DOM, в который будет рендериться компонент

Методы:
- `toggleClass` - переключение класса
- `setText`(protected) - устанавливает текстовое содержимое
- `setDisabled` - меняет статус блокировки
- `setHidden`(protected) - скрывает элемент
- `setVisible`(protected) - показывает элемент
- `setImage`(protected) - устанавливает изображение с альтернативным текстом
- `render` - возвращает обновленный контейнер компонента 

#### Класс Model`<T>`
Абстрактный класс, в котором хранятся данные, для последующей передачи\
\
`constructor(data: Partial<T>, protected events: IEvents)` - Конструктор класса инициализирует экземпляр модели и устанавливает объект для управления событиями\
\
Поля:
- `data: Partial<T>` - данные типа T, которые инициализируют поля модели при создании
- `events: IEvents`(protected) - предоставляет методы для работы с событиями

Метод: 
- `emitChanges` - сообщает о изменении модели

#### Класс Form`<T>`
Класс, нужный для управления интерактивности формы\
\
`constructor(protected container: HTMLFormElement, protected events: IEvents)` - Конструктор класса управляет событиями формы и их обработкой \
\
Поля: 
- `container: HTMLFormElement`(protected) - элемент формы, в который будет рендериться компонент
- `events: IEvents`(protected) - объект, реализующий интерфейс, для управления событиями
- `_submit: HTMLButtonElement`(protected) - элемент кнопки формы
- `_errors: HTMLElement`(protected) - элемент с сообщением ошибки 

Сеттеры:
- `set valid(value: boolean)` - управляет доступность кнопки(если true то кнопка станет доступной)
- `set errors(value: boolean)` - устанавлияет текст ошибки для пользователя\

Методы:
- `onInputChange`(protected) - событие при изменении значений в полях формы
- `render` - обновляет состояние формы

#### Класс Contact 
Класс отвечает за управление инпутами телефона и email.\
Выполняет роль расширения класса Form\
\
`constructor(container: HTMLFormElement, events: IEvents)` - Конструктор класса обеспечивает методы для управления событиями в форме, и передачи их в конструктор родительского класса\
\
Поля:
- `container: HTMLFormElement` - элемент формы, к которому будет привязан компонент Contacts
- `events: IEvents` - объект типа IEvents, предоставляющий методы для управления событиями в форме

Сеттеры:
- `set phone && email` - устанавливают значения в инпуты формы

#### Класс Order
Класс отвечает за управление инпутом адресса и выбором метода оплаты\
Выполняет роль расширения класса Form\
\
`constructor(container: HTMLFormElement, events: IEvents)` - Конструктор класса обеспечивает методы для управления событиями в форме, и передачи их в конструктор родительского класса\
\
Поля:
- `container: HTMLFormElement` - элемент формы, к которому будет привязан компонент Order
- `events: IEvents` - объект типа IEvents, предоставляющий методы для управления событиями в форме

Сеттеры:
- `set adress(value: string)` - устанавливает значение в инпут адреса в форме
- `set payment(name: string)` - управляет активным состоянием кнопок выбора способа оплаты

### Компоненты модели данных

#### Класс AppData
Класс для реализация работы с моделью приложения \
Наследуется от класса Model<IAppData>\
\
`constructor(data: Partial<IAppData>, events: IEvents)` - Конструктор класса инициализирует объект типа AppData, для управления данными приложения\
\
Поля:
- `data: Partial<IAppData>` - начальные данные типа IAppData, которые передаются конструктору родительского класса Model
- `events: IEvents` - объект типа IEvents, предоставляющий методы для управления событиями модели
- `catalog: IProduct[]` - массив продуктов, представляющих каталог приложения
- `basket: IProduct[] = []` - массив продуктов, представляющих корзину покупок. Инициализируется пустым массивом по умолчанию
- `order: IOrder = {...}` - объект, представляющий информацию о заказе. Инициализируется с пустыми значениями для полей phone, email, address, значения по умолчанию для payment, пустым массивом items и total равным 0

Методы:
- `addToBasket` - добавляет в корзину
- `removeFromBasket` - удаляет из корзины
- `clearBasket` - очищает корзину
- `getBasketLenght` - получает кол-во элементов в корзине
- `getTotalPrice` - получает общую стоимость корзины

### Классы представления

#### Класс Page
Класс который отвечает за управление различными элементами страницы и ее поведением\
Выполняет роль расширения класса Component\
\
`constructor(container: HTMLElement, protected events: IEvents)` - Конструктор класса инициализирует объект страницы, который наследует функционал компонента Component<IPage>\
\
Поля:
- `container: HTMLElement` - элемент контейнера страницы, к которому будет привязан компонент Page
- `events: IEvents` - объект типа IEvents, предоставляющий методы для управления событиями компонента
- `_counter: HTMLElement`(protected) - элемент счетчика корзины
- `_catalog: HTMLElement`(protected) - элемент каталога продуктов
- `_wrapper: HTMLElement`(protected) - обертка страницы
- `_basket: HTMLElement`(protected) - элемент корзины

Сеттеры:
- `set counter(value: number)` - устанавливает значение счетчика корзины
- `set catalog(items: HTMLElement[])` - управляет содержимым каталога, заменяет текущие дочерние элементы новыми
- `set locked(value: boolean)` - управляет состоянием блокировки страницы

#### Класс Basket
Класс который отвечает за отображение и управления корзиной\
Выполняет роль расширения класса Component\
\
`constructor(container: HTMLElement, protected events: EventEmitter)` - Конструктор класса обеспечивает инициализацию необходимых элементов DOM и установку обработчика событий для кнопки оформления заказа\
\
Поля:
- `container: HTMLElement` - элемент контейнера корзины, к которому будет привязан компонент Basket
- `events: EventEmitter` - объект типа EventEmitter, предоставляющий методы для управления событиями компонента
- `_list: HTMLElement`(protected) -  элемент списка товаров в корзине 
- `_total: HTMLElement`(protected) - элемент для отображения общей суммы заказа
- `_button: HTMLElement`(protected) - элемент кнопки оформления заказа

Сеттеры:
- `set items(items: HTMLElement[])` - устанавливает элементы товаров в корзине
- `set selected(items: string[])` - устанавливает доступность кнопки
- `set total(total: number)` - устанавливает общую сумму заказа в корзине

#### Класс Modal 
Класс представляющий собой компонент модального окна\
Выполняет роль расширения класса Component\
\
`container: HTMLElement, protected events: IEvents` - Конструктор класса инициализирует модальное окно, принимая элемент контейнера и объект событий\
\
Поля: 
- `container: HTMLElement` - элемент контейнера модального окна, к которому будет привязан компонент Modal
- `events: IEvents` - объект типа IEvents, предоставляющий методы для управления событиями компонента
- `_closeButton: HTMLButtonElement`(protected) - элемент кнопки закрытия модального окна 
- `_content: HTMLElement`(protected) - элемент контента модального окна 

Сеттеры:
- `set content(value: HTMLElement)` - устанавливает содержимое модального окна

Методы:
- `open` - открывает модальное окно путем добавления класса
- `close` - закрывает модальное окно путем удаления класса
- `render` - возвращает контейнер модального окна

#### Класс Card
Класс представляет компонент карточки продукта на веб-странице\
Выполняет роль расширения класса Component\
\
`constructor(container: HTMLElement, actions?: ICardActions)` - Конструктор класса инициализирует карточку товара с необходимыми элементами и обработчиком действия\
\
Поля:
- `container: HTMLElement` - элемент контейнера для карточки товара
- `actions?: ICardActions` - опциональный объект, содержащий действия, которые могут быть связаны с карточкой товара
- `_title: HTMLElement`(protected) - элемент заголовка карточки товара 
- `_image?: HTMLImageElement`(protected) - опциональный элемент изображения карточки товара
- `_price: HTMLElement`(protected) - элемент, отображающий цену товара
- `_category?: HTMLElement`(protected) - опциональный элемент, отображающий категорию товара
- `_description?: HTMLElement`(protected) - опциональный элемент, отображающий описание товара
- `_button?: HTMLButtonElement`(protected) - опциональный элемент кнопки действия на карточке товара

Сеттеры и Геттеры: 
- `set id(value: string) && get id(): string` - устанавливает и получает идентификатор карточки
- `set title(value: string) && get title(): string` - устанавливает и получает заголовок карточки.
- `set image(value: string)` - устанавливает изображение карточки и связанный с ним текст
- `set price(value: string) && get price(): string` - устанавливает и получает цену продукта, также управляет доступностью кнопки 
- `set category(value: string) && get category(): string` - устанавливает и получает категорию продукта, также добавляя класс из объекта
- `set description(value: string) && get description(): string` - устанавливает и получает описание продукта
- `set button(value: string)` - устанавливает текст на кнопке

### Типы и Интерфесы
- `IAppData` - описывает основные данные приложения
  - `products: IProduct[]` - массив объектов IProduct, представляющих товары, доступные в приложении
  - `basket: string[]` - массив строк, содержащий идентификаторы товаров, находящихся в корзине
  - `order: IOrder | null` - опциональный объект IOrder, представляющий текущий оформляемый заказ или значение null, если заказ не активен
- `IProduct` - описывает структуру продукта
  - `id:string` - уникальный идентификатор товара
  - `description: string` - описание или детали товара
  - `image: string` - URL или путь к изображению товара
  - `title: string` - название товара
  - `category: string` - категория, к которой относится товар
  - `price: number`- цена товара
- `IBasket` - описывает интерфейс корзины
  - `items: IProduct[]` - массив объектов IProduct, представляющих товары в корзине
  - `totalPrice: number` - общая стоимость всех товаров в корзине
  - `addItem(item: IProduct): void` - метод для добавления товара в корзину
  - `removeItem(itemId: IProduct): void` - метод для удаления товара из корзины
  - `calculateTotalPrice(): number` - метод для вычисления общей стоимости товаров в корзине
- `IOrder` - описывает структуру заказа, сделанного клиентом
  - `phone: string` - телефонный номер клиента
  - `email: string` - Email адрес клиента
  - `address: string` - адрес доставки клиента
  - `payment: string` - способ оплаты, выбранный клиентом
  - `items: string[]` - массив строк, содержащий идентификаторы товаров, включенных в заказ
  - `total: number` - общее кол-во товаров в заказе
- `IOrderStatus` - описывает структуру заказа
  - `status: string` - состояние заказа
  - `totalPrice: number` - общая стоимость заказа

#### Utils/constants 
`settings` - объект с категориями для сортировки
  

